
Function WorksheetExists(sheetName As String, Optional wb As Workbook) As Boolean
    Dim sht As Worksheet
    
    If wb Is Nothing Then Set wb = ActiveWorkbook
    On Error Resume Next
    Set sht = wb.Worksheets(sheetName)
    On Error GoTo 0
    WorksheetExists = Not sht Is Nothing
    
End Function


Function contains(var1, var2) As Boolean
   Dim currentObject
    
   For Each currentObject In var1
        If currentObject = var2 Then
            contains = True
            Exit Function
        End If
   Next currentObject
    
End Function

Function IsVarArrayEmpty(anArray As Variant) As Boolean

    Dim i As Integer
    
    On Error Resume Next
        i = UBound(anArray, 1)
    If Err.Number = 0 Then
        IsVarArrayEmpty = False
    Else
        IsVarArrayEmpty = True
    End If
End Function


Function NamedRangeExists(rgName As String, worksheetName As String) As Boolean
   
    Dim rngTest As Range
         
    On Error Resume Next
    Set rngTest = ActiveWorkbook.Worksheets(worksheetName).Range(rgName)
    If Err = 0 Then
        NamedRangeExists = True
        Exit Function
    Else
        NamedRangeExists = False
        Exit Function
    End If
End Function

Sub TurnOffFunctionality()
    Excel.Application.Calculation = xlCalculationManual
    Excel.Application.DisplayStatusBar = False
    Excel.Application.EnableEvents = False
    Excel.Application.ScreenUpdating = False
End Sub

Sub TurnOnFunctionality()
    Excel.Application.Calculation = xlCalculationAutomatic
    Excel.Application.DisplayStatusBar = True
    Excel.Application.DisplayAlerts = True
    Excel.Application.EnableEvents = True
    Excel.Application.ScreenUpdating = True
End Sub


Sub PDFWb()
    Dim spath As String, retval, defaultName As String, name As String, destinationFolder As String
    
    destinationFolder = "C:\Users\bgreen3" 
    
    defaultName = "UAP--" & Left(ActiveWorkbook.name, Len(ActiveWorkbook.name) - 5)
    name = Application.InputBox("Name of the file is:", Default:=defaultName)
    
    If name = "False" Then Exit Sub
    
     ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
            "destinationFolder" & name, Quality:=xlQualityStandard, _
            IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _
            False

End Sub